  <div class="container-fluid row mx-auto">
    <div class="col-md-4 col-lg-3 mb-4" id="cardWrapper" style="height: 630px">
        <div class="card bg-light text-center" id="profileCard" style="height: 100%;">
                <div class="text-center" style="position: relative;"> 
                    <img *ngIf="patient.user.imageName == NULL; else elseblock" 
                    class="card-img-top" style="margin-top: 10px;" src="assets/images/doctors/profile-pic.png"
                    alt="profile pic">
                    <ng-template #elseblock>
                        <img class="card-img-top" style="margin-top: 10px;" [src]="imageFromApi" alt="profile pic">
                    </ng-template>

                    <div id="uploadDiv">
                        <label for="file-upload" class="custom-file-upload">
                            <input type="file" id="file-upload"  name="file"
                            (change)="handleFileInput($event.target.files)" /> 
                            <i class="fas fa-2x fa-camera"></i>    
                        </label> <br>  
                        <span class="photo_text hidden-xs" style="color:black;">Upload</span>
                    </div>
                </div> 

                <div class="card-body">
                    <h5 class="card-title">{{patient.user.firstName}} {{patient.user.lastName}}</h5>
                    <span class="badge badge-success">User</span><br><br> 
                    <span class="btn btn-info" data-toggle="modal" data-target="#editData">Edit your information</span>

                </div>
        </div>
    </div>
    <div class="col-md-8 col-lg-9 mb-2" id="tabsWrapper" style="height: 100%;">     

        <nav class="bg-light justify-content-center" style="padding: 10px;">
            <div class="nav nav-tabs" id="nav-tab" role="tablist">
                <a class="nav-item nav-link active" id="nav-about-tab" data-toggle="tab" href="#nav-about"
                    aria-selected="true">
                    About you
                </a>
                <a class="nav-item nav-link" id="nav-sessions-tab" data-toggle="tab" href="#nav-sessions"
                    aria-selected="false">Sessions</a>
                <a class="nav-item nav-link" id="nav-notifications-tab" data-toggle="tab" href="#nav-notifications"
                    aria-selected="false">Sessions Feedback</a>
<!--                 <a class="nav-item nav-link" id="nav-issues-tab" data-toggle="tab" href="#nav-issues"
                    aria-selected="false">Report Issues</a> -->
            </div>
        </nav>
        <div class="tab-content bg-light p-3" id="nav-tabContent">
            <div class="tab-pane fade show active" id="nav-about"><!-- about tab -->
                
                <div class="container bootstrap snippet">
                    <div class="panel-body">
                        <div class="row"> 
                            <strong>Information</strong>
                            <br>  
                            <div class="table-responsive">
                                <table class="table table-user-information">
                                    <tbody>
                                        <tr>
                                            <td>
                                                <strong>
                                                    <i class="far fa-address-card"></i>
                                                    First Name
                                                </strong>
                                            </td>
                                            <td class="text-primary">
                                                {{patient.user.firstName}}
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <strong>
                                                    <i class="far fa-address-card"></i>
                                                    Last Name
                                                </strong>
                                            </td>
                                            <td class="text-primary">
                                                {{patient.user.lastName}}
                                            </td>
                                        </tr>

                                        <tr>
                                            <td>
                                                <strong>
                                                    <i class="fas fa-user-circle"></i>
                                                    Username
                                                </strong>
                                            </td>
                                            <td class="text-primary">
                                                {{patient.user.userName}}
                                            </td>
                                        </tr>


                                        <tr>
                                            <td>
                                                <strong>
                                                    <i class="far fa-envelope"></i>
                                                    Email
                                                </strong>
                                            </td>
                                            <td class="text-primary">
                                                {{patient.user.mail}}
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <strong>
                                                    <i class="fa fa-birthday-cake" aria-hidden="true"></i> 
                                                    Age
                                                </strong>
                                            </td>
                                            <td class="text-primary">
                                                {{patient.user.age}}
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <strong>
                                                    <i class="fas fa-venus-mars"></i>
                                                    Gender
                                                </strong>
                                            </td>
                                            <td class="text-primary">
                                                <span *ngIf="patient.user.gender == 1; else elseBlock">male</span>
                                                <ng-template #elseBlock>
                                                    <span>
                                                        female
                                                    </span>  
                                              </ng-template>                                            
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <strong>
                                                    <i class="fas fa-map-marker-alt"></i>
                                                    Address
                                                </strong>
                                            </td>
                                            <td class="text-primary">
                                                {{patient.user.address}}
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <strong>
                                                    <i class="fas fa-phone"></i>
                                                        Phone Number
                                                </strong>
                                            </td>
                                            <td class="text-primary">
                                                {{patient.user.phoneNumber}}
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <strong>
                                                    <i class="fas fa-syringe"></i>
                                                    Blood Type
                                                </strong>
                                            </td>
                                            <td class="text-primary">
                                                {{patient.user.bloodType}}
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <strong>
                                                    <i class="fas fa-book-medical"></i>
                                                    Medical History
                                                </strong>
                                            </td>
                                            <td class="text-primary">                    
                                                    <label *ngIf="patient.medicalHstoryName == NULL ; else mediclHistoryUploaded" for="cv-upload" class="pdf-upload">
                                                        <input type="file" id="cv-upload" class=""   name="file" (change)="handleFileMedicalHistory($event.target.files)"  />
                                                        <i class="fas fa-2x fa-file-pdf"></i><br>
                                                         <span>update</span>
                                                    </label>
                                                <ng-template #mediclHistoryUploaded>
                                                            <label for="cv-upload" class="pdf-upload">
                                                                <input type="file" id="cv-upload" class=""   name="file" (change)="handleFileMedicalHistory($event.target.files)"  />
                                                                <i class="fas fa-2x fa-file-pdf"></i><br>
                                                                 <span>update</span>
                                                            </label>
                                                            <div style="margin-left: 100px; margin-top: -60px;" >    
                                                                <span class="btn btn-success" (click)="SelectPatientForViewMd(patient)" data-toggle="modal" data-target="#MDModal">View </span> 

                                                            </div> 
                                                </ng-template>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="tab-pane fade" id="nav-sessions"><!-- sessions tab -->
                
                <table *ngIf="patientSessions.length>0; else noBookedSessions" class="table table-hover text-center">
                    <thead class="bg-primary text-light">
                        <tr>
                            <th scope="col">Doctor</th>
                            <th scope="col">Date</th>
                            <th scope="col">Time</th>
                            <th scope="col">Status</th>
                            <th scope="col">Operation</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let session of patientSessions">
                            <th scope="row">{{session.doctor.user.firstName}} {{session.doctor.user.lastName}}</th>
                            <td> {{session.schedule.date  | date:'shortDate'}}</td>
                            <td> {{session.schedule.startTime | date:'mediumTime'}}</td>
                            <td><span class="btn btn-primary" (click)="joinMeeting(session.scheduleId)">Join <i class="fas fa-video"></i></span></td>
                            <td><span class="btn btn-danger" (click)="cancelSession(session)">Cancel</span></td>
                        </tr>

                    </tbody>
                </table>
                
                <ng-template #noBookedSessions>
                    <div class="alert alert-primary text-center" role="alert" >
                       You haven't booked any session, Go to Home Page
                      </div>
                </ng-template>
            </div>
            <div class="tab-pane fade" id="nav-notifications" style="	background: #7F7FD5; height: 100%; overflow-y: scroll;
            background: -webkit-linear-gradient(to right, #91EAE4, #86A8E7, #7F7FD5);
             background: linear-gradient(to right, #91EAE4, #86A8E7, #7F7FD5); " ><!-- notifications tab -->

                <div *ngIf="PatientRaouchehs != NULL" >
                    <div  *ngFor="let PatientRaoucheh of PatientRaouchehs" style=" width: 100%; height: 100%;    
                    background-color: rgba(0,0,0,0.4) !important;" >

                    <div class="msg_cotainer">

                        <img src="../../../../assets/images/common/logo.png" width="100px" height="100px" style="border-radius: 50%;">

                            <h5 style="margin-left: 3px;">  Doctor : {{ PatientRaoucheh.doctor.user.firstName}} {{ PatientRaoucheh.doctor.user.lastName}}</h5>
                    </div>
                            
                <div class="form-group col-md-12 ">
                    <div class="msg_cotainer_send">
							
                    <label for="exampleFormControlTextarea1">Prescription</label>

                    


                    </div>

                  
                    <div class="form-group col-md-12  "style="margin-top:50px">
            
                    <textarea style=" margin-top: 40px;
                    margin-bottom: auto;
                    color: white;
                    margin-right: 15px;
                    border-radius: 25px;
                    width: 85%;
                    background-color: #57757c;
                    padding: 10px; " readonly="true" rows="8" class="form-control" disabled  name="comment" >{{PatientRaoucheh.doctorFeedback}}</textarea>
                    
                </div>
            </div>
                <div class="form-group col-md-12 ">
                    <div class="msg_cotainer_send" style="width: 275px;">
                    <label for="exampleFormControlTextarea1">The date of the next session :</label>
                    </div>
                    <textarea style="margin-top: auto; color: white;
                   margin-bottom: auto;
                    margin-right: 15px;
                    border-radius: 25px;
                    width: 80%;
                    background-color: #57757c;
                    padding: 10px;" rows="" class="form-control" disabled  name="comment" >{{PatientRaoucheh.description}} </textarea>
                    
                </div>




                  





                    </div>


                </div>





                
            </div>
<!--             <div class="tab-pane fade" id="nav-issues"><!-- issues tab --
                issues
            </div> --> 

        </div>

    </div>
</div>

<!-- Edit Modal  -->
  <div class="modal fade" id="editData" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">{{'Modal.EditInfo' | translate}}</h5>  
          <span  class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </span>
        </div>
        <div class="modal-body">
            <form name="form" #form="ngForm" class="formRegister" (ngSubmit)="onSubmit()">
                <div class="form-row"> 
                    <div class="form-group col-md-6">
                        <input type="text" class="form-control" placeholder="{{'Register.Fname' | translate}} *" name="fName"
                        #fName="ngModel"
                        [(ngModel)]=" patient_modified.user.firstName" 
                        required 
                        maxlength="20"
                        minlength="3"
                        noStartOrDoubleSpaces
                        pattern="^(?:[a-zA-Z\s@,=%$#&_\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDCF\uFDF0-\uFDFF\uFE70-\uFEFF]|(?:\uD802[\uDE60-\uDE9F]|\uD83B[\uDE00-\uDEFF])){0,30}$" 
                        [ngClass]="{ 'is-invalid': fName.invalid && fName.dirty }"> 
                        <span *ngIf="fName.dirty && fName.errors?.required" class="invalid-feedback">
                           {{"Register.Validation.Required" | translate}}</span> 
                    <!--cs validation -->
                        <div *ngIf="fName.invalid" class="invalid-feedback">
                            <span *ngIf="fName.errors?.minlength && fName.dirty">
                                {{"Register.Validation.MinLength3" | translate}}</span>
                            <span *ngIf="fName.errors?.startsWithSpace && fName.dirty">
                                {{"Register.Validation.SpaceStart" | translate}}</span>
                            <span *ngIf="fName.errors?.hasDoubleSpace && fName.dirty">
                                {{"Register.Validation.DoubleSpace" | translate}}</span>
                            <span *ngIf="fName.errors?.pattern&& fName.dirty">  
                                {{"Register.Validation.LettersOnly" | translate}}</span>
                        </div>
                    </div> 
                    <div class="form-group col-md-6">
                        <input type="text" class="form-control" placeholder="{{'Register.Lname' | translate}} *" name="lName"
                        #lName="ngModel"
                        [(ngModel)]=" patient_modified.user.lastName"
                        required 
                        maxlength="20"
                        minlength="3"
                        noStartOrDoubleSpaces
                        pattern="^(?:[a-zA-Z\s@,=%$#&_\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDCF\uFDF0-\uFDFF\uFE70-\uFEFF]|(?:\uD802[\uDE60-\uDE9F]|\uD83B[\uDE00-\uDEFF])){0,30}$" 
                        [ngClass]="{ 'is-invalid': lName.invalid && lName.dirty }">
                        <span *ngIf="lName.dirty && lName.errors?.required" class="invalid-feedback">
                            {{"Register.Validation.Required" | translate}}</span>
                    <!--cs validation -->
                        <div *ngIf="lName.invalid" class="invalid-feedback">
                            <span *ngIf="lName.errors?.minlength && lName.dirty">
                                {{"Register.Validation.MinLength3" | translate}}</span>
                            <span *ngIf="lName.errors?.startsWithSpace && lName.dirty">
                                {{"Register.Validation.SpaceStart" | translate}}</span>
                            <span *ngIf="lName.errors?.hasDoubleSpace && lName.dirty">
                                {{"Register.Validation.DoubleSpace" | translate}} </span>
                            <span *ngIf="lName.errors?.pattern&& lName.dirty">
                                {{"Register.Validation.LettersOnly" | translate}}</span> 
                        </div>
                    </div>   
                </div> 
                <div class="form-group">
                    <input type="text" class="form-control" placeholder="{{'Register.Username' | translate}} *" name="userName"
                    #userName="ngModel"  
                    [(ngModel)]=" patient_modified.user.userName"   
                    required
                    maxlength="30"
                    minlength="6"
                    noWhiteSpaces
                    pattern="^(?:[a-zA-Z0-9\s@,=%$#&_\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDCF\uFDF0-\uFDFF\uFE70-\uFEFF]|(?:\uD802[\uDE60-\uDE9F]|\uD83B[\uDE00-\uDEFF])){0,30}$" 
                    [ngClass]="{ 'is-invalid': userName.invalid && userName.dirty }" /> 
                    <span *ngIf="userName.dirty && userName.errors?.required" class="invalid-feedback">
                        {{"Register.Validation.Required" | translate}}</span>    
                    <!--cs validation --> 
                    <div *ngIf="userName.invalid" class="invalid-feedback">
                        <span  *ngIf="userName.errors?.minlength && userName.dirty">
                            {{"Register.Validation.MinLength6" | translate}}</span>
                        <span  *ngIf="userName.errors?.maxlength && userName.dirty">
                            </span>
                        <span *ngIf="userName.errors?.hasWhiteSpace && userName.dirty">
                            {{"Register.Validation.NoSpace" | translate}}</span>  
                        <span *ngIf="userName.errors?.pattern && userName.dirty">
                            {{"Register.Validation.LettersOnly" | translate}}</span>  
    
                    </div> 
                </div>
                <div class="form-group">
                    <input type="email" class="form-control" placeholder="{{'Register.Email' | translate}} *" name="email"
                    #email="ngModel"
                    [(ngModel)]=" patient_modified.user.mail"   
                    required
                    pattern="^([a-zA-Z0-9_\-\.]+)@([a-zA-Z0-9_\-\.]+)\.([a-zA-Z]{2,5})$"
                    [ngClass]="{ 'is-invalid': email.invalid && email.dirty }" />
                    <span *ngIf="email.dirty && email.errors?.required" class="invalid-feedback">
                        {{"Register.Validation.Required" | translate}}</span>  
                    <!--cs validation -->  
                    <div *ngIf="email.invalid" class="invalid-feedback">
                        <span  *ngIf="email.errors?.pattern && email.dirty"><!-- still need work -->
                            {{"Register.Validation.Email" | translate}}</span>
                        
                   </div> 
                </div>
    
                <div class="form-row">
                    <div class="form-group col-md-6">
                        <input type="text" class="form-control" placeholder="{{'Register.Address' | translate}}" name="address"
                        #address="ngModel"
                        [(ngModel)]=" patient_modified.user.address"
                        noStartOrDoubleSpaces
                        >
                        <!-- cs validation -->
                        <div *ngIf="address.invalid" class="invalid-feedback">
                            <span *ngIf="address.errors?.startsWithSpace && address.dirty">
                                {{"Register.Validation.SpaceStart" | translate}}</span>
                            <span *ngIf="address.errors?.hasDoubleSpace && address.dirty">
                                {{"Register.Validation.DoubleSpace" | translate}}</span>
                        </div>
    
                    </div>
                    <div class="form-group col-md-6">
                        <input type="text" class="form-control" placeholder="{{'Register.PhoneNumber' | translate}}" name="phone"
                        #phone="ngModel"
                        [(ngModel)]=" patient_modified.user.phoneNumber"  
                        noWhiteSpaces
                        > 
                        <!-- cs validation -->
                        <div *ngIf="phone.invalid" class="invalid-feedback">
                            <span *ngIf="phone.errors?.hasWhiteSpace && phone.dirty">
                                {{"Register.Validation.NoSpace" | translate}}</span>
                        </div>   
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group col-md-4">
                        <label>{{'Register.Gender' | translate}} *</label>
                        <select class="form-control" name="gender" #gender="ngModel" 
                        [(ngModel)]=" patient_modified.user.gender"
                        required
                        [ngClass]="{ 'is-invalid': gender.invalid && gender.touched }" 
                        >
                            <option  [ngValue]="null" disabled>{{'Register.Choose' | translate}}</option> 
                            <option value=1 >{{'Register.Male' | translate}}</option>
                            <option value=2>{{'Register.Female' | translate}}</option>
                        </select>
                        <div *ngIf="gender.touched && gender.errors?.required" class="invalid-feedback">
                            <span >{{"Register.Validation.Required" | translate}}</span>  
                        </div>  
                    </div>
                    <div class="form-group col-md-4">
                        <label>{{'Register.BloodType' | translate}}</label>
                        <select class="form-control" name="bloodType" #bloodType="ngModel" 
                        [(ngModel)]=" patient_modified.bloodType"
                        required
                        [ngClass]="{ 'is-invalid': bloodType.invalid && bloodType.touched }" 
    
                        >
                            <option  [ngValue]="null" disabled>{{'Register.Choose' | translate}}</option>
                            <option value=4>O-</option>      
                            <option value=36>O+</option>
                            <option value=3>A-</option>
                            <option value=28>A+</option>  
                            <option value=1>B-</option>
                            <option value=20>B+</option>
                            <option value=2>AB-</option>  
                            <option value=5>AB+</option>
                        </select>
                        <div *ngIf="bloodType.touched && bloodType.errors?.required" class="invalid-feedback">
                            <span >{{"Register.Validation.Required" | translate}}</span>  
                        </div>  
                    </div>
                    <div class="form-group col-md-4">
                        <label>{{'Register.Age' | translate}} *</label>
                        <input type="number" class="form-control" min="1" max="110" name="age" 
                        #age="ngModel"
                        [(ngModel)]=" patient_modified.user.age"
                        required
                        maxlength="3" 
                        [ngClass]="{ 'is-invalid': age.invalid && age.dirty }"   
                        >
                        <div *ngIf="age.invalid && age.errors?.required" class="invalid-feedback">
                            <span >{{"Register.Validation.Required" | translate}}</span>  
                        </div>  
                    </div>
                </div>   
                    <div class="modal-footer">
                        <button type="submit" class="btn btn-success" [disabled]="form.invalid" (click)="Update()" data-dismiss="modal" > {{"Modal.Edit" | translate}}</button>
    
                        <span  class="btn btn-secondary" data-dismiss="modal">{{"Modal.Close" | translate}}</span>
                      </div>              
            </form>     
         
        </div>
       
      </div>
    </div>
  </div>

              <!-- medical history modal ****************-->
               
 <div class="modal fade" id="MDModal" tabindex="-1" role="dialog"  aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">medical History View</h5>
          <span  class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </span>
        </div>
        <div class="modal-body">
         
        <div>
          <ngx-extended-pdf-viewer [src]='MedicalToView' 
          useBrowserLocale="true" height="70vh"></ngx-extended-pdf-viewer>
  
      </div>
  
        </div>
        <div class="modal-footer">
          <span  class="btn btn-secondary" data-dismiss="modal">Close</span>
        </div>
      </div>
    </div>
  </div>
  
  

