<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<div class="container" style="border-radius: 10px; margin-top: 50px;" id="doc">

    <div class="row text-center" style=" border-radius: 5%;">
        <div class="col-6" style="margin-top: 20px;  margin-bottom: 50px;">


            <span *ngIf="doctor.user.imageName == NULL; else elseCode">
                <img [src]="docImg"
                style=" border-style: solid; border-width: 5px; border-color: whitesmoke; border-radius: 60%; margin-top: 20px;"
                height="50%" width="200">
            </span>
            <ng-template #elseCode>
                <img [src]="DoctorImage"
                style=" border-style: solid; border-width: 5px; border-color: whitesmoke; border-radius: 60%; margin-top: 20px;"
                height="50%" width="200">
            </ng-template>
          


            <h1 class="" style="margin-top: 60px; color:aliceblue; font-family:'Times New Roman', Times, serif; margin-left: 20px;">
                Dr. {{doctor.user.firstName}} {{doctor.user.lastName}} </h1>
          <h2>{{doctor.speciality.name}}</h2>  
          <button *ngIf=" flagToRole == 1; " class="btn btn-success"(click)="SelectPatientForViewMd(patient)" data-toggle="modal" data-target="#reviewModal" > add Review </button>

        </div>
        <div class="col-6" style="margin-top: 20px; margin-bottom: 50px;">
          
                <div class="card text-center">
                    <div class="card-header">
                        <h4> Age : {{doctor.user.age}}</h4>
                    </div>
                    <div class="card-body">
                        <h5 class="card-title">Patients Rating </h5>
                        <h4>
                         
                            <div class="alert alert-dark">
                            
                                <star-rating value="5" [totalstars]="doctor.rating" checkedcolor="gold" uncheckedcolor="black" size="24px" readonly="false" (rate)="onRate($event)"></star-rating>

                            </div>
                        </h4>
    
                    </div>
                    <div class="card-footer text-muted">
                        <h3> Address : {{doctor.user.address}}</h3>
                        <h3> Phone : {{doctor.user.phoneNumber}}</h3>
                        <h3> E-Mail : {{doctor.user.mail}}</h3>
                        <button class="btn btn-warning"   > Get More
                                Details</button>
    
    
                </div>
        </div>
    </div>
   
</div>
</div>
<br>

<div class="container text-center"style="display:block;" >
    <div class="row text-center" style="border: 2px solid gray; border-radius: 10px ; margin: 5%; background-color: lavenderblush;">
        <span style="margin-left: 35%;" class="badge badge-dark">
            <h3>Select Date For Sessions   </h3>
             <input class="date" type="date" [value]="choocedDate" (input)="choocedDate =$event.target.value" (change)="GetDoctorScheduleTimes(doctor.userId ,choocedDate)"/>
        </span>
        

        <table [hidden]="!DoctorSchedule"  style="width: 70% ; margin: 10px auto;" class="table table-striped table-dark">
            <thead>
                <tr>
                  <th scope="col">Date</th>
                  <th scope="col">Start Time</th>
                  <th scope="col">End Time</th>
                  <th scope="col">Status</th>
                </tr>
              </thead>
              <tbody>
            <tr *ngFor="let time of DoctorSchedule;let i=Index"> 
                
                <td>
                    {{time.date  | date:'shortDate'}}
                </td> 
                 <td>
                     {{time.startTime | date:'mediumTime'}}
                </td>   
                <td>
                     {{time.endTime | date:'mediumTime'}}
                </td> 
                  
                    
                <td *ngIf="time.isBooked == 1; else elseBlock">

                    <span *ngIf="role == 'patient'; else Doc">
                        <button class="btn btn-success" disabled >
                            محجوز
                        </button>
                    </span>
                    <ng-template #Doc>
                        <button  class="btn btn-success" disabled >
                        محجوز
                        </button>
                        <button  class="btn btn-danger" (click)="cancelSession(time.id)">
                            إلغاء الحجز
                        </button>
                    </ng-template>
                
        
                   
                </td>
                <ng-template #elseBlock>

                    <span *ngIf="role == 'patient'; else Doc2">
                        <button class="btn btn-success" (click)="bookSession(time.id)">
                            إحجز الآن
                        </button>
                    </span>
                    <ng-template #Doc2>
                           <button  class="btn btn-success" disabled >
                            غير محجوز
                            </button>
                            <button  class="btn btn-danger"  (click)="deleteSession(time)">
                                إلغاء الميعاد
                            </button>
                    </ng-template>
            
           
                </ng-template>
        
        
        
            </tr>
              </tbody>
              <tfoot>
              <td colspan="4">              <button style="width: 100%;"  class="btn btn-danger" *ngIf="role == 'doctor'" (click)="CancelDaySessions(choocedDate)">Cancel This Day Sessions</button>
              </td>    

              </tfoot>
        </table>
    

       </div>
    

       <div class="modal fade" id="reviewModal" tabindex="-1" role="dialog"  aria-hidden="true">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">Review</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
             
                <div style="text-align:center">
                    <h1>
                     Rating
                    </h1>
                    <star-rating value="3" totalstars="5" checkedcolor="gold" uncheckedcolor="black" size="24px" readonly="false" (rate)="onRate($event)"></star-rating>
                  </div>

            <div class="form-group col-md-12">
                <label for="exampleFormControlTextarea1">add comment</label>
                <textarea rows="5" class="form-control" name="comment" placeholder="write Comment"
                [(ngModel)]="review.Comment"></textarea>

            </div>
      
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-success"  data-dismiss="modal" (click)="postReview()">Add Review</button>
            </div>
          </div>
        </div>
      </div>
      


      <div *ngIf="reviews != NULL" class="" style=" text-align: center; overflow-y: scroll;overflow-x:hidden; border-radius: 20px;
      width: 400px;height: 250px; background-color: rgb(225, 227, 231);float: right; margin: 15px auto; display: block;" >
      <h1 style="color: rgb(73, 64, 10); ">Reviews</h1>
       <div *ngFor="let _review of reviews" >
      <div class="review p-5" >
          <div class="row d-flex">
              <div class="profile-pic"><img src="https://localhost:44353/images/{{_review.patient.user.imageName}}" width="60px" height="60px"></div>
              <div class="d-flex flex-column pl-3">
                  <h4>{{_review.patient.user.firstName}}  {{_review.patient.user.lastName}}</h4>
              </div>
          </div>
          <div class="row pb-3" style="margin-left: 75px; margin-top: -20px;">
                               <star-rating [value]="_review.rating" [totalstars]="_review.rating" checkedcolor="gold" uncheckedcolor="gold" size="24px" readonly="true" (rate)="onRate($event)"></star-rating>
      
              </div>
          </div>
          <div class="row pb-3" style="margin-top: -50px;">
            <label for="exampleFormControlTextarea1" style="margin-left: 40px; display: block;">comment</label>
            <textarea style="width: 75%; border-radius: 20px; display: block; margin: 5px auto;" rows="3" class="form-control" name="comment" [placeholder]="_review.comment" disabled></textarea>
          
          </div>
        
      <hr/>
      
      </div>
      </div>
      